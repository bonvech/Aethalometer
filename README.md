# Aethalometer

Программное Обеспечение (ПО) для работы с прибором Аэталометр, модель АЕ33, компании Magee Scientific и Aerosol Со.

Созданное ПО предназначено для 
1. проверки работоспособности прибора путем периодического опроса состояния прибора АЕ33;
2. получения данных, зарегистрированных прибором, и сохранения их на сервере;
3. построения графиков по данным прибора и передачи их на веб-сервер Аэрозольного комплекса МГУ.

Прибор АЕ33 включен в сеть EtherNet, через имеющийся в его фукционале разъем LAN. IP-адрес прибору назначает роутер сети. Этот адрес отражается в соответствуещей вкладке на лицевой управляющей панели прибора АЕ33. Программа обращается к прибору АЕ33 через сеть по его IP-адресу.

В состав программы входят следующие модули:

– файл конфигурации, в котором указаны:

    IP-адрес прибора,
    номер последнего измерения, запрошенного из прибора,
    путь до директории с данными
– модуль определения класса прибора AE33, включающий следующие функции:

    функции установления соединения с прибором путем создания сокета и завершения соединения
    функция запроса на чтение данных из памяти прибора;
    функция обработки полученний данных и преобразования их в таблицы EXСEL и табличные файлы типа *.scv
    функция чтения данных, записываемых прибором на его внутрениий накопитель, и преобразования их в табличные файлы
    функция записи файлов на диск и защита файлов от несанкционированного вмешательства (изменения, стирания)
    
– модуль построения графиков по данным прибора:

    информация о работе приборов представляется в виде графиков следующих параметров:
      1. BCbb и Bcff на одном графике
      2. C1-BC7 на другом графике,
    информация на графиках представлена в двух временных интервалах: за последние 48 часов и за последние 14 дней. 

– файл основного программного модуля

– файл скрипта запуска программы на выполнение одного сеанса опроса прибора:

    файл написан на скриптовом языке командной строки ОС Windows
    предназначен для  размещения  в Планировщике заданий Windows

В программном обеспечении предусмотрено оперативное информирование оператора посредством информационно-коммуникационной сети 	интернет о неисправности прибора или невозможности связи с прибором:
1. При невозможности установления связи с прибором путем создания сокета программа посылает сообщение оператору. 
2. В случае, если за время, прошедшее с последнего запуска программы, прибор не получил новых данных оператору направляется соответствующее сообщение. Так как прибор регистрирует данные ежеминутно, отсутствие новых данных может свидетельствовать о неполадках в работе прибора.

Программное обеспечение написано на языке программирования Python. Может выполняться на компьютерах с операционной системой Windows, Linux, MacOs.

Скрипт запуска программы размещается в Планировщике заданий Windows и выполняется один раз в 60 минут. Частота запуска может быть изменена средствами операционной системы.

Программа прошла все необходимые тестирования и успешно работает уже несколько месяцев. При необходимости в неё вносятся соответствующие изменения.
